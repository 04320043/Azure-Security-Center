#New-ASCVASolution.ps1  
  This script will create new Qualys or Rapid7 vulnerability assessment (VA) solution in Azure Security Center (ASC).
   
## Description  
  ASC contract VA solution is provided as an integration service. This script uses REAST API to create new Security Solution in ASC.
  The solution requires a license and a key provided by the 3rd party VA provider: Qualys or Rapid7
  Note that only one solution can be created per license. An attempt to create another solution using the same name/license/key will fail.

### Usage
  **PARAMETER SubscriptionId
  The subscriptionID of the Azure Subscription that contains the resources you want to analyze

  **PARAMETER ResourceGroupName
  Mandatory. It can be any EXISTING resource group. using ASC default "DefaultResourceGroup-XXX" is one option.
  Note: Since the ASC VA solution is not Azure resource it will not be listed under the resource group, but still it is attached to it.

  **PARAMETER vaSolutionName
  The name of the new solution

  **PARAMETER vaType
  Qualys or Rapid7

  **PARAMETER autoUpdate
  Turn solution Austo deploy. 
  When On every new VM to the subscription will be automatically attempted to link to the solution.
  Default: False

  **PARAMETER licenceCode
  VA License string aquired from the vendor
  
  **PARAMETER publicKey
  Public key recieved from the vendor

### Examples
   .\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name> -vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false> -licenceCode '<License Code from vendor>' -publicKey '<Public Key recieved from vendor>'
   
   
   .\New-ASCVASolution.ps1 -subscriptionId f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b -resourceGroupName DefaultResourceGroup-WEU -vaSolutionName QualysVa001 -vaType Qualys -autoUpdate false `
   -licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
   -publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'

### Prerequisites
  Install-module Az
  Install-module Az.security
   
#### NOTES
   AUTHOR: Eli Sagie, Azure Security Center EEE 
   LASTEDIT: April 15, 2020 1.0
    - Initial Release
    - Special tanks to Arik Riklin!

#### LINK
    This script posted to and discussed at the following locations:
    https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts